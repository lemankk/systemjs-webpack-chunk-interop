{"version":3,"file":"index.umd.js","sources":["../src/index.js"],"sourcesContent":["(function (global) {\n  const systemPrototype = global.System.constructor.prototype;\n\n  const asyncImportPrefix = \"systemjs://m/\";\n  const getUrl = (id) => asyncImportPrefix + id;\n  systemPrototype.appendImportMap = async function (packages) {\n    const loader = this;\n    loader.asyncMap = loader.asyncMap || {};\n    loader.asyncMap = {\n      ...loader.asyncMap,\n      ...packages,\n    };\n\n    // creating import map from package\n    const packageNames = Object.keys(packages);\n    const sjsMapElm = document.createElement(\"script\");\n\n    // meet import map rules\n    sjsMapElm.type = \"systemjs-importmap\";\n\n    const packageMap = {};\n    for (const name of packageNames) {\n      // Use it directly if the package already provide an url, other assume that is a internal url with import syntax\n      packageMap[name] = typeof packages[name] === \"string\" ? packages[name] : getUrl(name);\n    }\n\n    sjsMapElm.innerText = JSON.stringify({\n      imports: packageMap,\n    });\n    document.head.appendChild(sjsMapElm);\n    return loader.prepareImport(true);\n  };\n  const existingHook = systemPrototype.instantiate;\n  systemPrototype.instantiate = function (url, parentUrl) {\n    var loader = this;\n\n    // use original loader\n    if (url.indexOf(asyncImportPrefix) !== 0) {\n      return existingHook.apply(loader, arguments);\n    }\n    var packageName = url.substr(asyncImportPrefix.length);\n    return new Promise(async (resolve, reject) => {\n      try {\n        const register = loader.getRegister();\n        const importer = loader.asyncMap[packageName];\n\n        // Using Webpack import()\n        const context = await importer();\n\n        loader.set(url, context);\n        resolve(register);\n      } catch (error) {\n        reject(error);\n      }\n    });\n  };\n  // eslint-disable-next-line\n})(typeof self !== \"undefined\" ? self : global);\n"],"names":["global","systemPrototype","System","constructor","prototype","asyncImportPrefix","getUrl","id","appendImportMap","packages","loader","asyncMap","packageNames","Object","keys","sjsMapElm","document","createElement","type","packageMap","name","innerText","JSON","stringify","imports","head","appendChild","prepareImport","existingHook","instantiate","url","parentUrl","indexOf","apply","arguments","packageName","substr","length","Promise","resolve","reject","register","getRegister","importer","context","set","self"],"mappings":"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"}